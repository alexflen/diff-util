# Курс основ программирования на МКН СПбГУ
## Проект 1: утилита diff

[Постановка задачи](./TASK.md)

### Использование утилиты
Ввод команды происходит одним из двух путей: через консоль или через параметры компиляции.
Команда имеет следующий вид: 
- имяфайла1 имяфайла2 [опции]

#### Что делает команда
Программа сравнивает два файла с именами (путями) имяфайла1 и имяфайла2 в стиле утилиты diff
и выводит различие между ними с учетом переданных опций.

#### Опции
Опции идут после имен файлов и должны начинаться с -. Параметры опций идут после объявления опции и знака =
- -i -- игнорировать пустые строки. Файлы будут сравниваться без учета пустых строк.
У опции нет параметров
- -w (-W) -- вывод не в консоль, а в файл. w перезаписывает содержимое файла, а W дозаписывает в файл.
Имя выходного файла передается как параметр в следующем формате -w=имявыходногофайла.
- -s -- параметры отображения строк. Параметры: u (показывать неизмененные строки), d (показывать удаленные строки),
a (показывать добавленные строки). Параметры передаются после знака равно, если нужно указать несколько параметров,
они указываются без пробелов подряд. Например, -s=au покажет неизмененные и добавленные строки.
- -h -- параметры скрытия дополнительной информации. Параметры: n (скрыть номера строк), i (скрыть информацию о
количествах каждого вида строк), s (скрыть вывод статуса (удалена, добавлена, не изменена) у каждой выведенной строки).
Параметры передаются так же, как и в -s.

Если в команде задано несколько одинаковых опций, учитывается только последняя из них.

#### Ввод команды
Вам нужно просто ввести команду одним из способов со всеми опциями, которые вы хотите
применить. Если что-то неправильно (например, имя файла или опция), программа скажет,
какая произошла ошибка. Пример команды:
- a.txt b.txt -i -s=ua -h=i -W=answ.txt. Здесь произойдет сравнение файлов a.txt и b.txt 
с игнорированием пустых строк, покажутся только неизмененные и добавленные строки, не покажется
информация о количествах строк, произойдет дозапись вывода команды в файл answ.txt

Если вызывать команду без параметров (или какого-то параметра), будут применены значения по умолчанию
(но имена двух файлов для сравнения обязательны).

По умолчанию:
- Пустые строки не игнорируются
- Выводятся все строки: неизмененные, удаленные и добавленные
- Выводится вся информация: номера строк, статус строки и информация о количествах
- Вывод результата происходит в консоль

#### Вывод программы
Пример вывода программы:

   [1]  +  It is added 1

(1)[2]  |  Hello

   [3]  +  It is added 2

   [4]  +  This is

(2)[5]  |  This is a file

(3)     -  It is deleted

   [6]  +  No no

(4)[7]  |  It is unchanged

Добавлено строк 4, удалено строк 1, не изменено 3

Здесь номера строк в первом файле даны в круглых скобках, а во втором файле -- в квадратных.
Если строки в файле нет, вместо этого выводится соответствующее количество пробелов для ровного вывода.
Далее в каждой строке идет ее статус -- + означает добавленную строку, - означает удаленную строку, | означает строку,
оставшуюся неизменной. Далее идет сама строка. В конце вывода выводится информация:
для каждого статуса строк выводится количество таких строк.

### Реализация
Утилита была реализована с помощью алгоритма поиска 
Наибольшей Общей Подпоследовательности. Были реализованы следующие функции:
- outputError -- функция вывода ошибки в консоль
- checkIfOkFormatParams -- функция проверки соблюдения формата вызова опции с параметром
- parseInput -- функция разбиения входной строки (из консоли) по пробелам
- numberLength -- функция возвращает длину целого числа
- writeAnywhere -- функция записи заданной строки в файл или нет (в зависимости от параметров)
- outputLine -- функция обработки и вывода (с помощью writeAnywhere) одной строки
- outputAnswer -- функция обработки результата поиска НОП и вывода строк ответа
  (с помощью функции outputLine). Строки выводятся в том порядке, в котором их
  определит метод указателей: поддерживаются указатели на строки добавленные, удаленные,
  пока идем главным указателем по неизменным строкам
- myHash -- функция возвращает хэш от заданной строки
- findLCS -- функция поиска НОП по строкам двух файлов. Строки сравниваются
с помощью хэшей для ускорения работы на больших файлах (с длинными строками)
- readFiles -- функция, которая читает два файла и записывает их содержимое в пару списков
- processCommand -- функция, обрабатывающая команду: она понимает, что делают опции
 и передает полученные параметры в функцию outputAnswer
- main -- запускает работу алгоритма

И были реализованы следующие классы:
- class LineNumbers -- по сути пара двух чисел: номер строки в первом файле и номер строки
во втором файле; нужна для возврата функции findLCS
- class LineInfo -- по сути три списка: добавленные, удаленные и неизменные строки,
информация о строках хранится с помощью LineNumbers; нужна для возврата функции findLCS

### Тестирование
Для тестирования проекта есть два файла-тестировщика:
- Test1.kt -- тестирует отдельные функции
- Test2.kt -- тестирует программу целиком

Тесты для Test2.kt хранятся в папке tests, в процессе тестирования задействуется
папка temp. В папке test хранятся файлы тестирования и ответы к ним. Чтобы получить большие тесты
(тесты 3 и 4), нужно запустить программу (generate_files.py), которая их генерирует,
сгенерированные тесты можно очистить с помощью программы clean_generated.py.
Большой сгенерированный файл весит около 55 Мб (тест 4). 